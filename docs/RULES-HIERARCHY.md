# 규칙 우선순위 및 체계 (Rules Hierarchy)

> **목적**: 프로젝트의 모든 규칙 문서 간 관계와 우선순위를 정의합니다.
> **마지막 업데이트**: 2026-01-22

---

## 문서 우선순위 (높음 → 낮음)

```
┌─────────────────────────────────────────────────────────┐
│  1. CLAUDE.md (최고 우선순위)                            │
│     - 팀장 핵심 규칙                                     │
│     - 팀원 위임 원칙 (CRITICAL)                          │
│     - 보고 형식                                          │
│     - MCP 활용 원칙                                      │
├─────────────────────────────────────────────────────────┤
│  2. .cursorrules                                        │
│     - 프로젝트 특정 규칙                                 │
│     - CLAUDE.md 참조                                     │
├─────────────────────────────────────────────────────────┤
│  3. CURSOR_USER_RULES.md                                │
│     - 상세 가이드라인                                    │
│     - 보안, 코드 아키텍처                                │
│     - 문제 해결 프로세스                                 │
├─────────────────────────────────────────────────────────┤
│  4. 에이전트/스킬 가이드라인                              │
│     - .claude/agents/*.md                               │
│     - .claude/skills/*/SKILL.md                         │
│     - 각 팀원별 작업 방법론                              │
└─────────────────────────────────────────────────────────┘
```

---

## 규칙 충돌 시 해결 원칙

### 원칙 1: 상위 문서 우선
- CLAUDE.md와 다른 문서가 충돌하면 → **CLAUDE.md 우선**
- .cursorrules와 CURSOR_USER_RULES.md가 충돌하면 → **.cursorrules 우선**

### 원칙 2: 명시적 규칙 우선
- "MUST", "MUST NOT", "FORBIDDEN", "CRITICAL" 키워드가 있는 규칙 우선
- 모호한 권장사항보다 명확한 금지사항 우선

### 원칙 3: 최신 업데이트 참조
- 동일 우선순위 문서 간 충돌 시 최신 업데이트 내용 우선

---

## 각 문서의 역할

### 1. CLAUDE.md (팀장 가이드)
**내용**:
- 팀장 역할 및 책임
- **팀원 위임 원칙 (CRITICAL)**
- **코드 작업 전 필수 체크리스트**
- 작업 보고 형식
- MCP 활용 원칙
- 세션 관리
- 프로젝트 아웃풋

**언제 읽는가**:
- 세션 시작 시 (자동)
- 코드 작업 요청 시 (위임 확인)
- 보고서 작성 시

### 2. .cursorrules (프로젝트 규칙)
**내용**:
- 프로젝트 정보
- 필수 읽기 문서 목록
- 문서 우선순위
- 빠른 참조 (팀원 매핑, 폴더 구조)

**언제 읽는가**:
- 프로젝트 처음 열 때
- 빠른 참조 필요 시

### 3. CURSOR_USER_RULES.md (상세 가이드라인)
**내용**:
- 세션 시작 프로세스
- 팀 구조 상세
- 작업 위임 가이드
- 보안 가이드라인
- 코드 아키텍처
- SQL 작성 원칙
- 문제 해결 프로세스

**언제 읽는가**:
- 상세 가이드라인 필요 시
- 보안/아키텍처 확인 시
- 문제 해결 시

### 4. 에이전트/스킬 가이드라인
**내용**:
- 각 팀원의 작업 방법론
- TDD 워크플로우 (tdd-agent)
- SQL 패턴 (supabase-helper)
- UI 디자인 가이드 (frontend-design)

**언제 읽는가**:
- 해당 팀원에게 작업 위임 전
- 해당 팀원의 작업 방식 확인 시

---

## 핵심 규칙 요약

### 🚨 CRITICAL (절대 위반 금지)

| 규칙 | 정의 문서 |
|-----|----------|
| 팀장 직접 코딩 금지 | CLAUDE.md |
| 담당 팀원 없는 보고서 무효 | CLAUDE.md |
| 코드/SQL 작업에 "팀장" 표기 금지 | CLAUDE.md |
| MCP로 직접 실행 (사용자 실행 요청 금지) | CLAUDE.md |

### 📋 MANDATORY (필수 준수)

| 규칙 | 정의 문서 |
|-----|----------|
| 세션 시작 시 자동 상태 확인 | CLAUDE.md, CURSOR_USER_RULES.md |
| 툴 교체 시 TOOL-SWITCH-LOG.md 확인 | CLAUDE.md, CURSOR_USER_RULES.md |
| 코드 작업 전 위임 체크리스트 확인 | CLAUDE.md |
| 작업 완료 후 검증 (타입 체크, 테스트) | tdd-agent.md |

### ⚠️ FORBIDDEN (금지)

| 규칙 | 정의 문서 |
|-----|----------|
| API 키 하드코딩 | CURSOR_USER_RULES.md |
| types/*.ts만 보고 SQL 작성 | tdd-agent.md, CURSOR_USER_RULES.md |
| 검증 없이 코드 제출 | tdd-agent.md |
| 프론트엔드에서 가격 계산 | CURSOR_USER_RULES.md |

---

## 규칙 업데이트 프로세스

### 새 규칙 추가 시

1. **범위 결정**
   - 팀 전체 → CLAUDE.md
   - 프로젝트 특정 → .cursorrules
   - 상세 가이드라인 → CURSOR_USER_RULES.md
   - 특정 팀원 → .claude/agents/*.md 또는 .claude/skills/*/SKILL.md

2. **우선순위 확인**
   - 기존 규칙과 충돌하는지 확인
   - 충돌 시 상위 문서 규칙 우선

3. **문서화**
   - 해당 문서에 규칙 추가
   - docs/WORK-LOG.md에 변경 기록

### 규칙 수정 시

1. **영향 범위 파악**
   - 하위 문서들에 영향 있는지 확인
   - 필요시 하위 문서도 업데이트

2. **일관성 유지**
   - 다른 문서들과 충돌하지 않는지 확인

---

## 체크리스트: 규칙 준수 확인

### 코드 작업 시
- [ ] CLAUDE.md의 위임 체크리스트 확인
- [ ] 담당 팀원 결정
- [ ] 팀원 가이드라인 읽기
- [ ] 작업 위임
- [ ] 결과 검증
- [ ] 보고서에 담당 팀원 명시

### 세션 시작 시
- [ ] docs/TOOL-SWITCH-LOG.md 확인 (툴 교체 시)
- [ ] docs/WORK-LOG.md 확인
- [ ] CLAUDE.md 규칙 확인
- [ ] 자동 상태 보고

### 보고서 작성 시
- [ ] 모든 작업에 담당 팀원 명시
- [ ] 코드/SQL 작업에 "팀장" 표기 없음
- [ ] 검증 결과 포함

---

**중요**: 이 문서는 규칙 체계의 가이드입니다. 실제 규칙은 각 문서에서 확인하세요.
