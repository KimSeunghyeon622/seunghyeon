• 검토 결과(중요도 순)
  1. 높음 — 민감한 데이터 변경이 클라이언트에서 직접 가능
     updateStore, updateStoreRating, updateReservationStatus, markAsPickedUp, createReview, updateReview, replyToReview, deleteReview 등은 모두 앱에서 직접 호출됩니다. RLS가 조금이라도 허술하면 악의적 클라이언트가 가게 정보/예약 상태/리
     뷰를 임의로 변경할 수 있습니다.
     파일: app/src/api/storeApi.ts:45-95, app/src/api/reservationApi.ts:71-105, app/src/api/reviewApi.ts:76-151
     대응: RLS를 엄격히 auth.uid() 기반으로 제한하고, 중요한 갱신은 RPC(SECURITY DEFINER)나 Edge Function으로 이동, 평점 집계는 DB 트리거나 서버에서 처리 권장.
  2. 높음 — 푸시 알림 전송을 클라이언트에서 직접 수행
     앱에서 Expo 푸시 API를 직접 호출하고, 사용자 푸시 토큰을 조회합니다. 토큰 접근이 열려 있으면 스팸/남용 위험이 큽니다.
     파일: app/src/lib/pushNotifications.ts:196-352
     대응: 푸시 전송은 서버(Edge Function)에서만 수행하고, 토큰은 서버만 접근하도록 RLS 제한.
  3. 높음 — exec_sql RPC 사용(테스트 스크립트)
     exec_sql RPC가 익명 클라이언트에 열려 있으면 DB 전체가 위험합니다.
     파일: app/test-supabase-mcp.js:23-90
     대응: 프로덕션에서는 제거하거나 서비스 롤 전용으로 제한.
  4. 중간 — 리뷰 이미지가 공개 URL
     getPublicUrl 사용으로 review-images 버킷이 공개일 가능성이 있습니다. 개인정보 포함 시 위험.
     파일: app/src/api/reviewApi.ts:22-48
     대응: private 버킷 + signed URL 권장.
  5. 중간 — .env가 저장소에 포함됨
     app/.env가 커밋되어 있습니다. 지금은 anon key라 하더라도 향후 키 유출 위험이 있습니다.
     파일: app/.env
     대응: .env 제거, .env.example로 대체, CI/비밀관리 사용.
  확인 필요
  1. stores, reservations, reviews, favorites, consumers 테이블 RLS가 실제로 엄격한가요?
  2. exec_sql RPC가 프로덕션 DB에 존재하나요?
  테스트/검증 공백
  1. 권한(RLS) 경계 테스트 부재
  2. 푸시 알림 흐름/토큰 접근 테스트 부재
